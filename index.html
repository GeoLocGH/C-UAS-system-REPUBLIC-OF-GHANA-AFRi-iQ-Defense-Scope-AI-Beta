<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AFRi-iQ Defense Scope AI - Control Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
        crossorigin=""/>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            /* Scrolling is now handled by the browser's default behavior */
        }
        .status-dot {
            height: 10px;
            width: 10px;
            border-radius: 50%;
            display: inline-block;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(0, 183, 255, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(0, 183, 255, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(0, 183, 255, 0); }
        }

        /* Pulse animation for the mission target */
        .target-marker-pulse {
            animation: target-pulse 2s infinite;
        }

        @keyframes target-pulse {
            0% {
                transform: scale(0.9);
                opacity: 0.7;
            }
            70% {
                transform: scale(2.5);
                opacity: 0;
            }
            100% {
                transform: scale(0.9);
                opacity: 0;
            }
        }
        
        /* Pulse animation for locked-on drones */
        .drone-locked-pulse {
            animation: drone-lock-pulse 1.5s infinite;
        }
        @keyframes drone-lock-pulse {
            0% { filter: drop-shadow(0 0 3px rgba(239, 68, 68, 0.8)); }
            70% { filter: drop-shadow(0 0 12px rgba(239, 68, 68, 0)); }
            100% { filter: drop-shadow(0 0 3px rgba(239, 68, 68, 0)); }
        }

        /* Pulse animation for failed anomalies */
        @keyframes failed-pulse {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }
        .failed-anomaly-pulse {
            animation: failed-pulse 2s infinite;
        }
        
        /* Animation for repaired anomalies fading out */
        @keyframes fade-out-marker {
            from { opacity: 1; transform: scale(1); }
            to { opacity: 0; transform: scale(0.5); }
        }
        .marker-fade-out {
            animation: fade-out-marker 1s ease-out forwards;
        }

        /* Animation for target elimination */
        @keyframes explosion-effect {
            0% {
                transform: scale(0.5);
                opacity: 1;
                background-color: white;
            }
            50% {
                background-color: #ffc107; /* amber-400 */
            }
            100% {
                transform: scale(3.5);
                opacity: 0;
                background-color: #ef4444; /* red-500 */
            }
        }
        .explosion-marker {
            border-radius: 50%;
            animation: explosion-effect 0.8s ease-out forwards;
            box-shadow: 0 0 15px #ffc107, 0 0 30px #ef4444;
        }

        /* Pulse animation for critical AI request borders */
        @keyframes border-pulse-critical {
            0% { border-color: rgba(239, 68, 68, 0.7); } /* red-500 */
            50% { border-color: rgba(239, 68, 68, 1); }
            100% { border-color: rgba(239, 68, 68, 0.7); }
        }
        .critical-request-pulse {
            animation: border-pulse-critical 1.5s infinite;
        }

        /* Pulse animation for high-priority AI request borders */
        @keyframes border-pulse-high {
            0% { border-color: rgba(245, 158, 11, 0.7); } /* amber-500 */
            50% { border-color: rgba(245, 158, 11, 1); }
            100% { border-color: rgba(245, 158, 11, 0.7); }
        }
        .high-request-pulse {
            animation: border-pulse-high 2s infinite;
        }

        /* Pulse animation for live telemetry */
        @keyframes text-pulse-cyan {
            0% { color: #67e8f9; /* cyan-300 */ }
            50% { color: #22d3ee; /* cyan-400 */ }
            100% { color: #67e8f9; /* cyan-300 */ }
        }
        .live-telemetry-pulse {
            animation: text-pulse-cyan 1.5s infinite;
        }

        /* Animation for C-UAS engaging line */
        @keyframes trace-fire {
            to {
                stroke-dashoffset: -30;
            }
        }
        .c-uas-engaging-line {
            stroke-dasharray: 15, 15;
            animation: trace-fire 1s linear infinite;
        }

        /* Styles for Replay Controls */
        .replay-controls-container {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(17, 24, 39, 0.9); /* bg-gray-900 with opacity */
            backdrop-filter: blur(8px);
            z-index: 40; /* Above map, below modals */
        }
        .replay-controls-container input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
        }
        .replay-controls-container input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: #2dd4bf; /* cyan-400 */
            cursor: pointer;
            margin-top: -6px; 
        }
        .replay-controls-container input[type=range]::-moz-range-thumb {
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: #2dd4bf; /* cyan-400 */
            cursor: pointer;
        }
        .replay-controls-container input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            cursor: pointer;
            background: #4b5563; /* gray-600 */
            border-radius: 2px;
        }

        /* Leaflet custom styles for dark theme */
        .leaflet-container {
            border-radius: 0.5rem; /* Match app's rounded-lg */
        }
        .leaflet-popup-content-wrapper, .leaflet-popup-tip {
            background: #1a202c; /* bg-gray-900 */
            color: #e2e8f0; /* text-gray-200 */
            border: 1px solid #4a5568; /* border-gray-600 */
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
        }
        .leaflet-popup-content {
            font-family: 'Inter', sans-serif;
            margin: 12px;
            line-height: 1.6;
        }
        .leaflet-popup-close-button {
            color: #e2e8f0 !important;
            top: 5px !important;
            right: 5px !important;
        }
        .leaflet-control-attribution {
            background: rgba(26, 32, 44, 0.7) !important;
            color: #a0aec0; /* text-gray-400 */
        }
        .leaflet-control-attribution a {
            color: #63b3ed; /* text-blue-400 */
        }
        .leaflet-control-zoom-in, .leaflet-control-zoom-out {
            background-color: #2d3748 !important; /* bg-gray-800 */
            color: #e2e8f0 !important; /* text-gray-200 */
            border-color: #4a5568 !important; /* border-gray-600 */
        }
        .leaflet-control-zoom-in:hover, .leaflet-control-zoom-out:hover {
            background-color: #4a5568 !important; /* bg-gray-600 */
        }

        /* Geofence label styles */
        .geofence-label {
            background-color: rgba(17, 24, 39, 0.7); /* bg-gray-900 with opacity */
            color: #e5e7eb; /* text-gray-200 */
            border: 1px solid rgba(75, 85, 99, 0.7); /* border-gray-600 with opacity */
            border-radius: var(--geofence-border-radius, 4px);
            padding: var(--geofence-padding-y, 4px) var(--geofence-padding-x, 8px);
            font-size: var(--geofence-font-size, 12px);
            font-weight: bold;
            box-shadow: none;
            white-space: nowrap;
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.1.1",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.1.1/",
    "react/": "https://aistudiocdn.com/react@^19.1.1/",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.24.0"
  }
}
</script>
<!-- Leaflet JS (must be before the main app script) -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""></script>
</head>
<body class="bg-gray-900 text-white">
<div id="root"></div>
<script type="module" src="/index.tsx"></script>
</body>
</html>